<!DOCTYPE html>
<html lang="ko">
<head>
    <!-- ... (기존 head 내용은 동일) ... -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="page-title"></title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Noto Sans KR', sans-serif; transition: background-color 0.3s ease, color 0.3s ease; }
        .chart-container{position:relative;width:100%;max-width:800px;margin-left:auto;margin-right:auto;height:400px;max-height:50vh}@media (min-width:768px){.chart-container{height:500px}}.card-enter{opacity:0;transform:translateY(20px);transition:opacity .5s ease-out,transform .5s ease-out}.card-enter-active{opacity:1;transform:translateY(0)}.modal-bg{transition:opacity .3s ease}.modal-content{transition:transform .3s ease,opacity .3s ease}.fade-in-card{opacity:0;transform:translateY(20px);transition:opacity .6s ease-out,transform .6s ease-out}.fade-in-card.is-visible{opacity:1;transform:translateY(0)}
    </style>
</head>
<body class="antialiased">

    <div id="app" class="container mx-auto px-4 sm:px-6 lg:px-8 py-8 md:py-12">
        <div class="flex justify-between items-center mb-8">
            <a href="https://pebblous.ai" target="_blank" rel="noopener noreferrer">
                 <img id="page-logo" src="" alt="Pebblous Logo" class="h-8">
            </a>
            <div id="theme-switcher" class="flex items-center space-x-2 border rounded-full p-1">
                <!-- 테마 버튼들은 스크립트가 동적으로 생성합니다 -->
            </div>
        </div>

        <header class="text-center mb-16">
             <!-- ... (기존 header 내용은 동일) ... -->
        </header>

        <main>
            <!-- [TODO] 본문 콘텐츠 -->
        </main>
    </div>

    <footer class="themeable-footer">
        <!-- ... (기존 footer 내용은 동일) ... -->
    </footer>
    
    <div id="investorModal" class="fixed inset-0 z-50 flex items-center justify-center p-4 hidden">
        <!-- ... (기존 modal 내용은 동일) ... -->
    </div>
    
    <script src="config.js" defer></script>
    
    <script>
        let interestChartInstance = null; // 차트 인스턴스를 저장할 전역 변수

        document.addEventListener('DOMContentLoaded', function() {
            const defaultConfig = { /* ... 기본값 ... */ };
            const finalConfig = (typeof siteConfig !== 'undefined') ? { ...defaultConfig, ...siteConfig, theme: { ...defaultConfig.theme, ...siteConfig.theme } } : defaultConfig;
            
            // --- 1. 테마 시스템 초기화 ---
            setupThemeSwitcher(finalConfig.themes, finalConfig.defaultTheme);
            
            // --- 2. SEO 및 기본 정보 적용 ---
            applyStaticConfig(finalConfig);

            // --- 3. 애플리케이션 로직 실행 ---
            runApp(finalConfig);
        });

        function setupThemeSwitcher(themes, defaultTheme) {
            const switcher = document.getElementById('theme-switcher');
            const themeIcons = {
                dark: `<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path></svg>`,
                light: `<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path></svg>`,
                beige: `<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path></svg>`
            };
            
            Object.keys(themes).forEach(themeName => {
                const button = document.createElement('button');
                button.dataset.theme = themeName;
                button.innerHTML = themeIcons[themeName] || themeName.charAt(0).toUpperCase();
                button.className = 'p-1 rounded-full transition-colors duration-300';
                button.onclick = () => applyTheme(themes[themeName], button);
                switcher.appendChild(button);
            });

            const urlParams = new URLSearchParams(window.location.search);
            const themeFromUrl = urlParams.get('theme');
            const initialTheme = (themeFromUrl && themes[themeFromUrl]) ? themeFromUrl : defaultTheme;
            
            const initialButton = switcher.querySelector(`[data-theme="${initialTheme}"]`);
            applyTheme(themes[initialTheme], initialButton);
        }

        function applyTheme(theme, activeButton) {
            document.body.style.backgroundColor = theme.background;
            document.body.style.color = theme.textColor;

            // 동적 스타일 시트 업데이트
            let styleSheet = document.getElementById('dynamic-theme-styles');
            if (!styleSheet) {
                styleSheet = document.createElement("style");
                styleSheet.id = 'dynamic-theme-styles';
                document.head.appendChild(styleSheet);
            }
            styleSheet.innerText = `
                .themeable-card, .themeable-investor-card { background-color: ${theme.cardBackground}; border-color: ${theme.borderColor}; }
                .themeable-heading { color: ${theme.headingColor}; }
                .themeable-accent, .themeable-accent-border { color: ${theme.accentColor}; border-color: ${theme.accentColor}; }
                .themeable-footer { background-color: ${theme.footerBackground}; }
                .hover-accent:hover { color: ${theme.accentColor} !important; }
                .themeable-card p, #page-meta-info, p { color: ${theme.textColor};}
                #analytics { border-color: ${theme.borderColor};}
                main h2 { border-color: ${theme.borderColor};}
                .themeable-accent-border { border-color: ${theme.accentColor};}
                footer, footer .border-t { border-color: ${theme.borderColor}; }
                #modal-summary, #modal-reason { background-color: ${theme.background};}
            `;

            // 활성 버튼 스타일 업데이트
            document.querySelectorAll('#theme-switcher button').forEach(btn => {
                btn.style.color = theme.textColor;
                btn.style.backgroundColor = 'transparent';
            });
            if(activeButton) {
                activeButton.style.color = theme.background;
                activeButton.style.backgroundColor = theme.textColor;
            }

            // 차트 업데이트
            if (interestChartInstance) {
                interestChartInstance.options.scales.x.ticks.color = theme.textColor;
                interestChartInstance.options.scales.y.ticks.color = theme.textColor;
                interestChartInstance.options.scales.x.grid.color = 'rgba(255, 255, 255, 0.1)';
                interestChartInstance.update();
            }
        }

        function applyStaticConfig(config) { /* ... SEO, 로고, 발행일 등 정적 정보 적용 로직 ... */ }
        function runApp(config) { /* ... 투자사 데이터 렌더링 및 차트 생성 로직 ... */ }
        
    </script>
</body>
</html>


