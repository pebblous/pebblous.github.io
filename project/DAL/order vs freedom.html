<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>질서와 자유의 변주곡</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans KR', sans-serif;
            overflow: auto; /* Allow scrolling to show controls */
            min-height: 100vh;
        }
        canvas {
            display: block;
            background-color: #111827; /* dark gray background */
        }
        /* Custom slider styles */
        input[type=range] {
            -webkit-appearance: none;
            width: 100%;
            background: transparent;
        }
        input[type=range]:focus {
            outline: none;
        }
        input[type=range]::-webkit-slider-runnable-track {
            width: 100%;
            height: 8px;
            cursor: pointer;
            background: #374151;
            border-radius: 5px;
        }
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            height: 24px;
            width: 24px;
            border-radius: 50%;
            background: #60a5fa;
            cursor: pointer;
            margin-top: -8px; /* Center thumb on track */
            box-shadow: 0 0 10px rgba(96, 165, 250, 0.7);
        }
        input[type=range]::-moz-range-track {
            width: 100%;
            height: 8px;
            cursor: pointer;
            background: #374151;
            border-radius: 5px;
        }
        input[type=range]::-moz-range-thumb {
            height: 24px;
            width: 24px;
            border-radius: 50%;
            background: #60a5fa;
            cursor: pointer;
            border: 0;
            box-shadow: 0 0 10px rgba(96, 165, 250, 0.7);
        }
    </style>
</head>
<body class="bg-gray-900 text-gray-200 flex flex-col min-h-screen">

    <!-- Header -->
    <header class="p-4 md:p-6 text-center shadow-lg bg-gray-800/50 backdrop-blur-sm z-10">
        <h1 class="text-2xl md:text-3xl font-medium text-blue-300">질서와 자유의 변주곡</h1>
        <p class="text-sm md:text-base text-gray-400 mt-1">엔트로피, 예술, 그리고 시각적 즐거움에 대한 성찰</p>
    </header>

    <!-- Main Content -->
    <main class="flex-grow flex flex-col md:flex-row items-center justify-center relative">
        <canvas id="pebbleCanvas"></canvas>

        <!-- Controls and Text Overlay -->
        <div class="absolute bottom-0 left-0 right-0 p-4 md:p-6 bg-gray-900/70 backdrop-blur-sm rounded-t-lg">
            <div class="max-w-4xl mx-auto grid grid-cols-1 md:grid-cols-3 gap-6 items-center">
                
                <!-- Slider Control -->
                <div class="md:col-span-1 flex flex-col justify-center">
                    <label for="freedomSlider" class="text-lg font-semibold mb-2 text-center text-blue-300">자유도 (Freedom)</label>
                    <div class="flex items-center space-x-4">
                        <span class="text-sm text-gray-400">질서 (Order)</span>
                        <input id="freedomSlider" type="range" min="0" max="100" value="0" class="w-full">
                        <span class="text-sm text-gray-400">무질서 (Chaos)</span>
                    </div>
                </div>

                <!-- Explanatory Text -->
                <div class="md:col-span-2 text-sm text-gray-300 font-light">
                    <p>
                        "문명은 에너지를 투입하여 질서를 유지하고 엔트로피를 낮춥니다. 하지만 무질서 속에 아름다움이 있고, 이것이 더 자연스럽습니다.
                        슬라이더를 움직여 질서(낮은 엔트로피)와 자유로운 무질서(높은 엔트로피) 사이의 시각적 변화를 탐험해보세요."
                    </p>
                </div>
            </div>
        </div>
    </main>

    <script>
        const canvas = document.getElementById('pebbleCanvas');
        const ctx = canvas.getContext('2d');
        const slider = document.getElementById('freedomSlider');

        let pebbles = [];
        let freedom = 0;
        let baseHue = 150; // Start with a greenish hue

        // --- Configuration ---
        const pebbleGridSize = 25; // Gap between pebbles in the grid

        class Pebble {
            constructor(x, y, radius, hue) {
                this.originX = x;
                this.originY = y;
                this.x = x;
                this.y = y;
                this.originRadius = radius;
                this.radius = radius;
                this.originHue = hue;
                this.hue = hue;
                this.saturation = 70;
                this.lightness = 65;
            }

            // Update pebble properties based on freedom value
            update() {
                const freedomFactor = freedom / 100;

                // 1. Update Position: Move away from origin based on freedom
                const angle = Math.random() * Math.PI * 2;
                const displacement = Math.random() * freedomFactor * (pebbleGridSize * 1.5);
                this.x = this.originX + Math.cos(angle) * displacement;
                this.y = this.originY + Math.sin(angle) * displacement;

                // 2. Update Radius: Vary size based on freedom
                const radiusVariation = (Math.random() - 0.5) * freedomFactor * (this.originRadius * 0.8);
                this.radius = Math.max(2, this.originRadius + radiusVariation);

                // 3. Update Color: Shift hue based on freedom
                const hueShift = (Math.random() - 0.5) * freedomFactor * 180; // Allow wide color shifts at high freedom
                this.hue = (this.originHue + hueShift + 360) % 360;
            }

            // Draw the pebble on the canvas
            draw() {
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
                ctx.fillStyle = `hsl(${this.hue}, ${this.saturation}%, ${this.lightness}%)`;
                ctx.fill();
                ctx.strokeStyle = `hsla(${this.hue}, ${this.saturation}%, ${this.lightness - 20}%, 0.5)`;
                ctx.lineWidth = 1;
                ctx.stroke();
            }
        }
        
        // Function to initialize or reset the pebbles
        function init() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            pebbles = [];

            const pebbleCountX = Math.floor(canvas.width / pebbleGridSize);
            const pebbleCountY = Math.floor(canvas.height / pebbleGridSize);
            const offsetX = (canvas.width - (pebbleCountX - 1) * pebbleGridSize) / 2;
            const offsetY = (canvas.height - (pebbleCountY - 1) * pebbleGridSize) / 2;

            for (let i = 0; i < pebbleCountX; i++) {
                for (let j = 0; j < pebbleCountY; j++) {
                    const x = offsetX + i * pebbleGridSize;
                    const y = offsetY + j * pebbleGridSize;
                    const radius = pebbleGridSize * 0.4;
                    
                    // Create a color gradient across the screen
                    const hue = baseHue + (i / pebbleCountX) * 180; // Green (150) to Red/Magenta (330)

                    pebbles.push(new Pebble(x, y, radius, hue));
                }
            }
        }
        
        // Main animation loop
        function animate() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            pebbles.forEach(pebble => {
                pebble.update();
                pebble.draw();
            });

            requestAnimationFrame(animate);
        }

        // --- Event Listeners ---
        slider.addEventListener('input', (e) => {
            freedom = e.target.value;
        });

        // Re-initialize on window resize
        let resizeTimer;
        window.addEventListener('resize', () => {
            clearTimeout(resizeTimer);
            resizeTimer = setTimeout(init, 250); // Debounce resize event
        });
        
        // --- Start ---
        init();
        animate();

    </script>
</body>
</html>

